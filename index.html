<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LifePet v6.0 - Ultimate Edition</title>
    <style>
        :root { --p: #6c5ce7; --bg: #f0f2f5; --card: #ffffff; --gold: #f1c40f; --energy: #3498db; --night: #2d3436; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding-bottom: 90px; transition: 0.5s; overflow-x: hidden; }
        body.night { background: var(--night); color: white; }
        .nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); z-index: 1000; border-radius: 20px 20px 0 0; }
        body.night .nav { background: #333; }
        .nav-item { flex: 1; text-align: center; padding: 15px; cursor: pointer; font-size: 20px; transition: 0.3s; }
        .nav-item.active { color: var(--p); transform: translateY(-5px); }
        .page { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card { background: var(--card); padding: 15px; border-radius: 20px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); color: #333; border: 1px solid #eee; }
        .btn { background: var(--p); color: white; border: none; padding: 12px; width: 100%; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .box { background: #f9f9f9; padding: 12px; text-align: center; border-radius: 15px; cursor: pointer; border: 1px solid #eee; transition: 0.2s; }
        .box:active { transform: scale(0.95); }
        .box.selected { border: 2px solid var(--p); background: #f3f0ff; }
        .stat-bar { height: 10px; background: #ddd; border-radius: 5px; overflow: hidden; margin: 10px 0; }
        .fill { height: 100%; background: var(--energy); transition: 0.5s; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 10px; border: 1px solid #ddd; box-sizing: border-box; }
        .quick-tag { font-size: 11px; background: #f0f0f0; padding: 5px 10px; border-radius: 15px; margin: 3px; display: inline-block; cursor: pointer; border: 1px solid #ddd; }
        .pet-display { font-size: 90px; position: relative; display: inline-block; margin: 20px 0; }
        .acc-overlay { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 40px; pointer-events: none; }
    </style>
</head>
<body>

<div id="auth-screen" style="padding: 40px 20px; text-align: center;">
    <h1 style="color: var(--p);">LifePet v6.0 ğŸ¾</h1>
    <div id="auth-inputs">
        <input type="email" id="email" placeholder="E-mail">
        <input type="password" id="pass" placeholder="Wachtwoord">
        <button class="btn" onclick="handleAuth()">LOG IN / START</button>
    </div>
    
    <div id="setup-inputs" style="display:none; margin-top:20px;">
        <h3>Kies je Pet & Naam</h3>
        <input type="text" id="petName" placeholder="Hoe heet je pet?">
        <div class="grid" id="pet-choice-grid">
            </div>
        <button class="btn" onclick="completeSetup()" style="background:#00b894;">ADOPTEER PET</button>
    </div>
</div>

<div id="game-ui" style="display:none;">
    <div id="p1" class="page active">
        <div class="card" style="text-align: center;">
            <div id="ui-evo" style="font-size: 10px; color: var(--p); font-weight: bold; text-transform: uppercase;">Ei-Fase</div>
            <div class="pet-display">
                <div id="ui-acc" class="acc-overlay"></div>
                <div id="ui-emoji">ğŸ¥š</div>
            </div>
            <h2 id="ui-name" style="margin:0">Naam</h2>
            <div style="background: var(--gold); color: white; padding: 10px; border-radius: 15px; font-weight: bold; margin-top: 10px;">ğŸ’° <span id="ui-coins">0</span></div>
            <div style="text-align: left; margin-top: 20px;">
                <small>Energie âš¡</small><div class="stat-bar"><div id="ui-energy-bar" class="fill"></div></div>
            </div>
        </div>
        <div class="card">
            <b>Rugzak (Klik om te gebruiken):</b>
            <div id="ui-inv" class="grid" style="margin-top:10px;"></div>
        </div>
    </div>

    <div id="p2" class="page">
        <h3>ğŸ“… Weekschema</h3>
        <div id="planner-fields"></div>
        <button class="btn" style="background:#00b894;" onclick="saveData()">ğŸ’¾ OPSLAAN</button>
        <hr>
        <h4>Taken voor Vandaag</h4>
        <div id="ui-today"></div>
    </div>

    <div id="p3" class="page">
        <h3>ğŸ›ï¸ Winkel</h3>
        <div class="card">
            <p><b>ğŸ Markt (Eten & Energie)</b></p>
            <div class="grid">
                <div class="box" onclick="buy('ğŸ', 10, 'food')">ğŸ<br><small>ğŸ’°10</small></div>
                <div class="box" onclick="buy('ğŸ•', 40, 'food')">ğŸ•<br><small>ğŸ’°40</small></div>
                <div class="box" onclick="buy('ğŸª', 5, 'food')">ğŸª<br><small>ğŸ’°5</small></div>
                <div class="box" onclick="buy('ğŸ”', 60, 'food')">ğŸ”<br><small>ğŸ’°60</small></div>
            </div>
        </div>
        <div class="card">
            <p><b>ğŸ© Boutique (Accessoires)</b></p>
            <div class="grid">
                <div class="box" onclick="buy('ğŸ©', 100, 'acc')">ğŸ©<br><small>ğŸ’°100</small></div>
                <div class="box" onclick="buy('ğŸ‘‘', 500, 'acc')">ğŸ‘‘<br><small>ğŸ’°500</small></div>
                <div class="box" onclick="buy('ğŸ•¶ï¸', 150, 'acc')">ğŸ•¶ï¸<br><small>ğŸ’°150</small></div>
                <div class="box" onclick="buy('ğŸ€', 80, 'acc')">ğŸ€<br><small>ğŸ’°80</small></div>
            </div>
        </div>
    </div>

    <div class="nav">
        <div class="nav-item" onclick="show('p1')">ğŸ¾</div>
        <div class="nav-item" onclick="show('p2')">ğŸ“…</div>
        <div class="nav-item" onclick="show('p3')">ğŸ›ï¸</div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, onSnapshot, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyCNeVLw0NYgKQrpBC7MuArQAJ5Kli9Xd3o", authDomain: "petlife-68738.firebaseapp.com", projectId: "petlife-68738", appId: "1:942954717479:web:6a8fafe8c7b17d00444902" };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const DAYS = ["Zondag", "Maandag", "Dinsdag", "Woensdag", "Donderdag", "Vrijdag", "Zaterdag"];
    const PETS = ["ğŸ¶","ğŸ±","ğŸ²","ğŸ¦Š","ğŸ¼","ğŸ¦„","ğŸ¦","ğŸ°","ğŸ¨","ğŸ¯","ğŸ£","ğŸ·"];
    const QUICK = ["ğŸ§¹ Afwassen", "ğŸƒ Wandelen", "ğŸ§˜ Yoga", "ğŸ§º Was doen", "ğŸ›’ Boodschappen"];

    let st = { setupDone: false, name: "Pet", type: "ğŸ¶", coins: 0, energy: 100, inv: {}, plan: {}, done: [], currentAcc: "" };
    let tempType = "ğŸ¶";

    window.handleAuth = () => {
        const e = document.getElementById('email').value, p = document.getElementById('pass').value;
        if(!e || !p) return alert("Vul e-mail en wachtwoord in");
        signInWithEmailAndPassword(auth, e, p).catch(() => createUserWithEmailAndPassword(auth, e, p));
    };

    onAuthStateChanged(auth, async user => {
        if(user) {
            const snap = await getDoc(doc(db, "users", user.uid));
            if(snap.exists()) {
                st = snap.data();
                startApp();
            } else {
                showSetup();
            }
        }
    });

    function showSetup() {
        document.getElementById('auth-inputs').style.display = 'none';
        document.getElementById('setup-inputs').style.display = 'block';
        const grid = document.getElementById('pet-choice-grid');
        PETS.forEach(p => {
            const b = document.createElement('div');
            b.className = 'box';
            b.innerText = p;
            b.onclick = () => { 
                tempType = p; 
                document
